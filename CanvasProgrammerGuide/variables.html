<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Variables &mdash; Fabric Engine 2.0.0 Unofficial Documentation (ja)</title>
    
    <link rel="stylesheet" href="../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '2.0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/translations.js"></script>
    <link rel="top" title="Fabric Engine 2.0.0 Unofficial Documentation (ja)" href="../index.html" />
    <link rel="up" title="Canvas Programmer Guide" href="index.html" />
    <link rel="next" title="Caches" href="caches.html" />
    <link rel="prev" title="Polymorphic nodes" href="polymorphism.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>ナビゲーション</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="総合索引"
             accesskey="I">索引</a></li>
        <li class="right" >
          <a href="caches.html" title="Caches"
             accesskey="N">次へ</a> |</li>
        <li class="right" >
          <a href="polymorphism.html" title="Polymorphic nodes"
             accesskey="P">前へ</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Fabric Engine 2.0.0 Unofficial Documentation (ja)</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Canvas Programmer Guide</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="variables">
<span id="canvas-programmer-guide-variables"></span><h1>Variables<a class="headerlink" href="#variables" title="このヘッドラインへのパーマリンク">¶</a></h1>
<div class="admonition note">
<p class="first admonition-title">注釈</p>
<p class="last">If you are looking for a less technical explanation please refer to <a class="reference internal" href="../CanvasUserGuide/variables.html#canvas-user-guide-variables"><span>Variables</span></a> in the user guide.</p>
</div>
<p>Variables allow to declare and use named containers within a graph.
Variables hold stateful values that will continue to exist between
graph evaluations.</p>
<p>Variables can be useful for various situations:</p>
<ul class="simple">
<li>Creating a graph-owned value that evolves from evaluation to evaluation,
such as a counter or a simulation.</li>
<li>Reducing the number of ports for exposing common contextual data to deep
sub-graphs, for example the <cite>currentFrameIndex</cite>. This can be seen as
implementing a closure, where the parent graph is setting up its own
evaluation context for all its sub-graphs.</li>
<li>Using a unique, shared value: a KL Object created as a variable
will be accessible by other graphs (see <a class="reference internal" href="#canvas-variables-scope"><span>Variable scope</span></a>),
allowing to use shared storage.</li>
</ul>
<p>While variables provide stable and shared states between graph evaluations,
their values are not saved with the graph. After loading the graph, variables are
always reset to their initial value.</p>
<div class="admonition warning">
<p class="first admonition-title">警告</p>
<p class="last">While variables can be used to build more powerful graphs,
their statefulness could lead to issues that are hard to debug and reproduce
if not used carefully.</p>
</div>
<div class="section" id="variable-nodes">
<span id="canvas-variable-nodes"></span><h2>Variable nodes<a class="headerlink" href="#variable-nodes" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>In order to be read (<em>get</em>) or written (<em>set</em>), variables must first
be declared with a <em>new variable</em> node (see <a class="reference internal" href="#canvas-variable-creation"><span>Creating variable nodes</span></a>).
The variable node holds the existence of its the actual value container, and
must exist in order to <em>get</em> or <em>set</em> variable&#8217;s value.</p>
<p>The <em>new variable</em> node has an input port for specifying an initial value,
which will be pulled only at the very first graph evaluation.
Its output returns the current value of the node, and as such it acts
like a <em>get</em> node. However, the <em>new variable</em> node&#8217;s output doesn&#8217;t have
to be connected for to effectively declare the variable.</p>
<p>The <em>set</em> node will change the value of a variable, and its output
will return its new value. The <em>get</em> node only has an output port returning
variable&#8217;s current value. The execution order (or port order) between <em>set</em>
and <em>get</em> nodes is very important, since the value of a <em>get</em> node will
differ if it executes before or after a <em>set</em> node. While it is guaranteed
that a <em>get</em> node connected on the left of a <em>set</em> node will execute before
it, other situations might require more care to ensure that the execution
order is the expected one.</p>
<div class="admonition note">
<p class="first admonition-title">注釈</p>
<p class="last">If a <em>get</em> or <em>set</em> variable node refer to an undeclared or inaccessible variable
(see <a class="reference internal" href="#canvas-variables-scope"><span>Variable scope</span></a>), an error will be reported, for example:
<cite>Node &#8216;get&#8217;: unable to resolve var path &#8216;A&#8217;</cite>. Note that this error will
be resolved as soon as an accessible variable is created.</p>
</div>
</div>
<div class="section" id="creating-variable-nodes">
<span id="canvas-variable-creation"></span><h2>Creating variable nodes<a class="headerlink" href="#creating-variable-nodes" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>In the Canvas application, variables nodes can be added in the following ways:</p>
<ul class="simple">
<li>In the Canvas Graph window, right-click will bring a contextual menu:<ul>
<li><em>New Variable</em> will open the <em>New Variable</em> dialog to define a new variable in the current graph.</li>
<li><em>Read Variable (Get)</em> will add a <em>get variable</em> node.</li>
<li><em>Write Variable (Set)</em> will add a <em>set variable</em> node.</li>
</ul>
</li>
<li>In the Canvas Graph window, the <em>Tab</em> key will open a search widget in which:<ul>
<li>typing &#8220;var.&#8221; will open the <em>New Variable</em> dialog to define a new variable in the current graph.</li>
<li>typing &#8220;get.&#8221; will give a list of available variables that are accessible
from the current graph, and selecting one of these will create a <em>get</em> node for
that variable.</li>
<li>typing &#8220;set.&#8221; will a list of available variables that are accessible
from the current graph, and selecting one of these  will create a <em>set</em> node for
that variable.</li>
</ul>
</li>
<li>The explorer window has a <em>Variables</em> root item which shows the path
of existing graph variables. Dropping these in the Canvas Graph window will
create a <em>get variable</em> node with the <strong>absolute path</strong> of the variable.</li>
</ul>
</div>
<div class="section" id="variable-scope">
<span id="canvas-variables-scope"></span><h2>Variable scope<a class="headerlink" href="#variable-scope" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>While variables are always accessible from the graph where they are declared
(<em>new variable</em> node), they might be accessible from other graphs based
on some simple scoping rules.</p>
<p>In order to bind a <em>get</em> or <em>set</em> node to a variable, the variable path
must resolve to an accessible variable. The variable will first be searched
in the same graph. If not found, the variable will be searched in the
parent graph, and so on until the top graph is reached.</p>
<p>If not found, the variable path will then be resolved as
an <em>absolute path</em>, that is, its path from the top graph down
to its actual declaration (<em>new variable</em>) node, for example
<cite>myGraph.mySubGraph.A</cite>.</p>
<p>Because variables are searched from the current graph and up,
this allows to implement <em>closures</em>, and these can be overridden
by children graphs. For example, a <cite>Time</cite> variable could be defined
at the top graph level, and a sub-graph could implement time
remapping by defining its own relative <cite>Time</cite> with a different value.
Of course this assumes that sub-graphs are accessing the time with
a <em>get Time</em> node.</p>
<p>Because variable name bindings are dynamically resolved at graph
modification time, it is fine for a preset to require a variable
(<em>get</em> or <em>set</em> node) not declared inside it. As such, it
assumes that the variable will be defined by its parent graphs.</p>
</div>
<div class="section" id="variable-versus-cache">
<span id="canvas-variables-versus-cache"></span><h2>Variable versus Cache<a class="headerlink" href="#variable-versus-cache" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>While both a cache node and a variable create a stateful value container
within a graph, the following differences should be noted:</p>
<ul class="simple">
<li>A cache node will be recomputed if its input value or sub-graph
changes, whereas variables&#8217; value is initialized only at the first evaluation.
As such, a variable can be used to ensure that a same KL object is reused
for all graph evaluations (if no <em>set variable</em> node sets a new object).</li>
<li>A cache node should only be used for performance, as it has
no effect on the actual graph result. However, variables can
have an effect on the behavior of the graph because they can
accumulate changes from evaluation to evaluation.</li>
</ul>
</div>
<div class="section" id="example">
<span id="canvas-variables-example"></span><h2>Example<a class="headerlink" href="#example" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>In the example below, the <cite>GetElapsedSeconds</cite> preset initializes the <cite>lastTicks</cite>
variable as the current ticks. Then, at each evaluation, the existing <cite>lastTicks</cite>
value gets compared with the newly updated value, and the difference is outputted
in seconds.</p>
<img alt="../_images/canvasVariables_elapsedSeconds.png" src="../_images/canvasVariables_elapsedSeconds.png" />
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/FE_logo_211_37.png" alt="Logo"/>
            </a></p>
  <h3><a href="../index.html">目次</a></h3>
  <ul>
<li><a class="reference internal" href="#">Variables</a><ul>
<li><a class="reference internal" href="#variable-nodes">Variable nodes</a></li>
<li><a class="reference internal" href="#creating-variable-nodes">Creating variable nodes</a></li>
<li><a class="reference internal" href="#variable-scope">Variable scope</a></li>
<li><a class="reference internal" href="#variable-versus-cache">Variable versus Cache</a></li>
<li><a class="reference internal" href="#example">Example</a></li>
</ul>
</li>
</ul>

  <h4>前のトピックへ</h4>
  <p class="topless"><a href="polymorphism.html"
                        title="前の章へ">Polymorphic nodes</a></p>
  <h4>次のトピックへ</h4>
  <p class="topless"><a href="caches.html"
                        title="次の章へ">Caches</a></p>
  <div role="note" aria-label="source link">
    <h3>このページ</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/CanvasProgrammerGuide/variables.txt"
            rel="nofollow">ソースコードを表示</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>クイック検索</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="検索" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    モジュール、クラス、または関数名を入力してください
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>ナビゲーション</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="総合索引"
             >索引</a></li>
        <li class="right" >
          <a href="caches.html" title="Caches"
             >次へ</a> |</li>
        <li class="right" >
          <a href="polymorphism.html" title="Polymorphic nodes"
             >前へ</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Fabric Engine 2.0.0 Unofficial Documentation (ja)</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >Canvas Programmer Guide</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2010-2015 Fabric Software Inc.
      このドキュメントは <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.1 で生成しました。
    </div>
  </body>
</html>