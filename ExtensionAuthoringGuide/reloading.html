<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Extension Reloading &mdash; Fabric Engine 2.0.0 Unofficial Documentation (ja)</title>
    
    <link rel="stylesheet" href="../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '2.0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/translations.js"></script>
    <link rel="top" title="Fabric Engine 2.0.0 Unofficial Documentation (ja)" href="../index.html" />
    <link rel="up" title="Extension Authoring Guide" href="index.html" />
    <link rel="next" title="Licensing Guide" href="../LicensingGuide/index.html" />
    <link rel="prev" title="Calling Convention for Exported Functions" href="cconv.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>ナビゲーション</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="総合索引"
             accesskey="I">索引</a></li>
        <li class="right" >
          <a href="../LicensingGuide/index.html" title="Licensing Guide"
             accesskey="N">次へ</a> |</li>
        <li class="right" >
          <a href="cconv.html" title="Calling Convention for Exported Functions"
             accesskey="P">前へ</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Fabric Engine 2.0.0 Unofficial Documentation (ja)</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Extension Authoring Guide</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="extension-reloading">
<span id="eag-reloading"></span><h1>Extension Reloading<a class="headerlink" href="#extension-reloading" title="このヘッドラインへのパーマリンク">¶</a></h1>
<div class="versionadded">
<p><span class="versionmodified">バージョン 1.13.0 で追加.</span></p>
</div>
<p>KL extension code can be reloaded in a running Fabric Engine instance inside any DCC or in a standalone application. Right clicking on a Canvas node also provides the option of reloading any dependent extensions of that node.</p>
<p>In general reloading a KL extension is most useful when the memory layout of extension types and their function prototypes do not need to change but the user wants to update the implementations of existing functions. Reloading extensions should be safe as long as users are aware of the considerations mentioned below.</p>
<div class="section" id="api-functions">
<h2>API Functions<a class="headerlink" href="#api-functions" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>The relevant API functions for reloading KL extension code are <cite>FEC_ClientLoadExtension</cite> and <cite>FEC_RegisterKLExtension</cite> in the C API and <cite>Client::loadExtension()</cite> and <cite>RegisterKLExtension</cite> in the C++ and Python APIs. See <a class="reference internal" href="../CAPIProgrammingGuide/clients.html#clients"><span>Clients and the Application Lifecycle</span></a> for more information on these functions and their parameters. The <cite>reload</cite> parameter on these functions is new, if set to 0 then these functions will error out as they would in the past if a user tries to load an extension that&#8217;s already been loaded, however if set to 1 then that extension will be reloaded from disk (or from the provided source code in the case of <cite>RegisterKLExtension</cite>).</p>
</div>
<div class="section" id="updating-kl-type-member-layout">
<h2>Updating KL Type Member Layout<a class="headerlink" href="#updating-kl-type-member-layout" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>The memory representation or member layout of a KL type can not be changed by reloading an extension and will result in an error if the user tries. In order to change the memory representation of KL type all Core Clients must be shut down and restarted. For example attempting to add a member to a struct called &#8216;MyStruct&#8217; while making a reload call will result in an error that looks like:</p>
<div class="highlight-python"><div class="highlight"><pre>[FABRIC:MT] [MyExt] MyExt.kl:2:1: error: type &#39;MyStruct&#39; already registered with a different definition
[FABRIC:MT] [MyExt] Error encountered while loading extension; extension disabled
[FABRIC:MT] [MyExt] Error description: KL compile failed: type &#39;MyStruct&#39; already registered with a different definition
</pre></div>
</div>
</div>
<div class="section" id="updating-kl-source-code">
<h2>Updating KL Source Code<a class="headerlink" href="#updating-kl-source-code" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>All extension KL source code can be updated when reloading an extension, however there are several important caveats to be aware of.</p>
<div class="section" id="extension-dependencies">
<h3>Extension Dependencies<a class="headerlink" href="#extension-dependencies" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>In the case of an extension which is dependent on a reloaded one, the behavior depends on whether the functions being called are marked as <cite>function</cite> or as <cite>inline</cite> in the reloaded extension. For example if extension <cite>Foo</cite> looks like this:</p>
<div class="highlight-python"><div class="highlight"><pre>struct FooType
{
  Scalar a;
};

function FooType.bar()
{
  report(&#39;called FooType.bar()&#39;);
}

inline FooType.foo()
{
  report(&#39;called FooType.foo()&#39;);
}
</pre></div>
</div>
<p>And extension <cite>Bar</cite> looks like this:</p>
<div class="highlight-python"><div class="highlight"><pre>require Foo;

struct BarType
{
  FooType foo;
};

function BarType.myFunction()
{
  this.foo.foo();
  this.foo.bar();
}
</pre></div>
</div>
<p>Then if the source code of <cite>Foo</cite> is reloaded to provide different implementations for the <cite>foo()</cite> and <cite>bar()</cite> methods, the <cite>Bar</cite> type will only reflect the changes in the non-inlined <cite>bar()</cite> method. In order to change the implementation of the inlined <cite>foo()</cite> the <cite>Bar</cite> extension would need to be recompiled and the Core does not automatically reload dependent extensions (though the user is free to reload it manually, which will force a recompilation).</p>
</div>
<div class="section" id="changing-function-prototypes-or-adding-removing-functions">
<h3>Changing Function Prototypes or Adding/Removing Functions<a class="headerlink" href="#changing-function-prototypes-or-adding-removing-functions" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>If the prototype of an existing KL function is changed inside an extension (to change the parameter types, or add or remove parameters) or if new functions are added or removed then any new KL code written against this extension will be able to use the new functions, however any existing code in dependent extensions that still refer to the old function prototypes will continue to work but will use the old function. This can lead to confusing scenarios where dependent extensions are using KL functions that may no longer exist in any visible way.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/FE_logo_211_37.png" alt="Logo"/>
            </a></p>
  <h3><a href="../index.html">目次</a></h3>
  <ul>
<li><a class="reference internal" href="#">Extension Reloading</a><ul>
<li><a class="reference internal" href="#api-functions">API Functions</a></li>
<li><a class="reference internal" href="#updating-kl-type-member-layout">Updating KL Type Member Layout</a></li>
<li><a class="reference internal" href="#updating-kl-source-code">Updating KL Source Code</a><ul>
<li><a class="reference internal" href="#extension-dependencies">Extension Dependencies</a></li>
<li><a class="reference internal" href="#changing-function-prototypes-or-adding-removing-functions">Changing Function Prototypes or Adding/Removing Functions</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>前のトピックへ</h4>
  <p class="topless"><a href="cconv.html"
                        title="前の章へ">Calling Convention for Exported Functions</a></p>
  <h4>次のトピックへ</h4>
  <p class="topless"><a href="../LicensingGuide/index.html"
                        title="次の章へ">Licensing Guide</a></p>
  <div role="note" aria-label="source link">
    <h3>このページ</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/ExtensionAuthoringGuide/reloading.txt"
            rel="nofollow">ソースコードを表示</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>クイック検索</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="検索" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    モジュール、クラス、または関数名を入力してください
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>ナビゲーション</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="総合索引"
             >索引</a></li>
        <li class="right" >
          <a href="../LicensingGuide/index.html" title="Licensing Guide"
             >次へ</a> |</li>
        <li class="right" >
          <a href="cconv.html" title="Calling Convention for Exported Functions"
             >前へ</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Fabric Engine 2.0.0 Unofficial Documentation (ja)</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >Extension Authoring Guide</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2010-2015 Fabric Software Inc.
      このドキュメントは <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.1 で生成しました。
    </div>
  </body>
</html>